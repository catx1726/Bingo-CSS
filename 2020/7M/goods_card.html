<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>GoodsCard</title>
    <link rel="stylesheet" href="../css/main.css" />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css?family=Open+Sans+Condensed:300,700"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.5.9/slick.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.5.9/slick-theme.min.css"
    />
    <style>
      * {
        padding: 0;
        margin: 0;
      }
      .main_container,
      .main_bg-fade {
        height: 100vh;
        font-family: 'Open Sans Condensed', sans-serif;
        /* background: linear-gradient(15deg, #d33f34 50%, #a61322 50.1%); */
        transition: all 0.3s ease;
      }
      .main_bg-fade {
        width: 100%;
        z-index: -1;
        background: linear-gradient(15deg, #d33f34 50%, #a61322 50.1%);
        position: absolute;
      }
      .card_container .item {
        z-index: 10;
        height: 40rem;
        width: 35rem;
        position: relative;
        border-radius: 5px;
        background-color: #f5f5f5;
      }
      .item_title {
        color: black;
        font-weight: 700;
        font-size: 3rem;
      }
      .item_subtitle {
        font-weight: 100;
        font-size: 1.5rem;
      }
      .slider figure {
        width: 25rem;
        overflow: hidden;
        object-fit: contain;
      }
      .slider figure img {
        width: 25rem;
        left: 50%;
        position: relative;
        object-fit: contain;
        transform: translate(-50%);
      }
      .slider .slick-dots {
        bottom: 1.5rem;
      }
      .slick-dots a {
        position: relative;
        display: block;
        width: 16px;
        height: 16px;
      }
      .slick-dots span {
        top: 50%;
        left: 50%;
        width: 6px;
        height: 6px;
        border-radius: 50%;
        position: absolute;
        transform: translate(-50%, -50%);
      }
      .slick-dots circle {
        fill: none;
        stroke-width: 1;
        stroke-linecap: round;
        stroke-dasharray: 39 39;
        stroke-dashoffset: 39;
        transition: all 0.9s ease-in-out;
        transition: stroke-dashoffset 0.5s;
      }
      .slick-active circle {
        stroke-dashoffset: 0;
      }

      .item_trigger {
        bottom: 10%;
        width: 100%;
        position: absolute;
      }
      .item_des {
        color: #4795d1;
        font-weight: bold;
        font-size: 1.5rem;
        transition: all 0.3s ease;
      }
      .buy_btn {
        font-weight: bold;
        padding: 12px 18px;
        border-radius: 20px;
        border: 1px solid #4795d1;
        color: #4795d1;
        outline: none;
        cursor: pointer;
        display: inline-block;
        position: relative;
        background-color: white;
        transition: all 0.3s ease;
        z-index: 1;
        overflow: hidden;
      }
      .bg {
        opacity: 0;
        top: 0;
        left: 0;
        width: 101%;
        height: 101%;
        display: block !important;
        z-index: -1;
        position: absolute;
        transition: all 0.3s ease-in-out;
        background: linear-gradient(135deg, #a61322, #d33f34);
      }
      .buy_btn:hover .bg {
        opacity: 1;
      }
      .buy_btn:hover {
        color: white !important;
      }
    </style>
  </head>
  <body>
    <main class="main_container m-flex flex-jc-center flex-an-center">
      <div class="card_container">
        <div class="item box-shadow-obt-m">
          <div class="title_container m-flex flex-jc-center flex-an-center flex-dir-col">
            <span class="item_title">
              Nike Metcon 2
            </span>
            <span class="item_subtitle">
              Men's training shoe
            </span>
          </div>
          <div class="slider m-flex flex-jc-center">
            <figure data-color="#E24938, #A30F22">
              <img src="http://www.supah.it/dribbble/012/1.jpg" />
            </figure>
            <figure data-color="#6CD96A, #00986F">
              <img src="http://www.supah.it/dribbble/012/2.jpg" />
            </figure>
            <figure data-color="#4795D1, #006EB8">
              <img src="http://www.supah.it/dribbble/012/3.jpg" />
            </figure>
            <figure data-color="#292a2f, #131519">
              <img src="http://www.supah.it/dribbble/012/4.jpg" />
            </figure>
          </div>
          <div class="item_trigger m-flex flex-jc-around flex-an-center">
            <span class="item_des">130$</span>
            <button class="buy_btn">
              add to cart
              <span class="bg"></span>
            </button>
          </div>
        </div>
      </div>
      <div class="main_bg-fade"></div>
    </main>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.5.9/slick.min.js"></script>
    <script>
      $(document).ready(function () {
        let $slider = $('.slider')
        $('.slider')
          .slick({
            arrows: false,
            dots: true,
            infinite: true,
            speed: 600,
            fade: true,
            focusOnSelect: true,
            customPaging: (slider, i) => {
              /*
                DES 获取到指定的 date-color 然后在点击 dot 的时候 ，改变 BG 颜色
                DES jquery 的方式是 .data ，原生则是  dataset.name
                */
              var color = $(slider.$slides[i]).data('color').split(',')[1]
              /*
                DES 自定义 dot，svg 让效果更好
                */
              return (
                '<a><svg width="100%" height="100%" viewBox="0 0 16 16"><circle cx="8" cy="8" r="6.215" stroke="' +
                color +
                '"></circle></svg><span style="background:' +
                color +
                '"></span></a>'
              )
            }
          }) // DES 链式调用，详细参看 https://github.com/kenwheeler/slick/#events
          .on('beforeChange', (eve, slick, curSlide, nextSlide) => {
            // DES 触发修改颜色的函数
            var colors = $('figure', $slider).eq(nextSlide).data('color').split(','),
              color1 = colors[0],
              color2 = colors[1]
            // DES 改变价格的颜色
            $('.item_des,.buy_btn').css({
              color: color1
            })
            $('.buy_btn').css({
              borderColor: color1
            })
            // OK 改变背景颜色
            changeBG(color1, color2)
          })
      })

      function changeBG(c1, c2) {
        // FIXME 2020年7月1日 background 没有 transition ... 我会有闪频情况..
        $('.main_container').css(bkgd(c1, c2))
        $('span.bg').css({ background: 'linear-gradient(135deg, ' + c1 + ',' + c2 + ')' })
      }

      function bkgd(c1, c2) {
        return {
          background: '-moz-linear-gradient(15deg, ' + c1 + ' 50%, ' + c2 + ' 50.1%)',
          background: '-o-linear-gradient(15deg, ' + c1 + ', ' + c2 + ' 50.1%)',
          background: '-webkit-linear-gradient(15deg, ' + c1 + ' 50%, ' + c2 + ')',
          background: '-ms-linear-gradient(15deg, ' + c1 + ' 50%, ' + c2 + ' 50.1%)',
          background: 'linear-gradient(15deg, ' + c1 + ' 50%,' + c2 + ' 50.1%)'
        }
      }
    </script>
  </body>
</html>
